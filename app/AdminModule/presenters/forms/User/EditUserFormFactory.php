<?phpnamespace App\AdminModule\Presenters\Forms\User;use Nette\Application\UI\Form;use DbTable;class EditUserFormFactory {  /** @var DbTable\Users */	private $users;  /**   * Edit hlavne menu form component factory.   * @return Nette\Application\UI\Form   */    public function create(DbTable\Users $users, $id_reg, $urovneReg, $user_view_fields)  {    $this->users = $users;    $form = new Form();		$form->addProtection();    $form->addHidden('id');$form->addHidden('id_users');$form->addHidden('created');$form->addHidden('modified');		$form->addText('meno', 'Meno:', 50, 80)				 ->addRule(Form::MIN_LENGTH, 'Meno musí mať spoň %d znakov!', 3)				 ->setRequired('Meno musí byť zadané!');    $form->addText('priezvisko', 'Priezvisko:', 50, 80)				 ->addRule(Form::MIN_LENGTH, 'Priezvisko musí mať spoň %d znakov!', 3)				 ->setRequired('Priezvisko musí byť zadané!');    $form->addText('username', 'Užívateľské meno', 50, 50)				 ->addRule(Form::MIN_LENGTH, 'Užívateľské meno musí mať aspoň %s znakov', 3)				 ->setRequired('Užívateľské meno musí byť zadané!');    $form->addText('email', 'E-mailová adresa', 50, 50)         ->setType('email')				 ->addRule(Form::EMAIL, 'Musí byť zadaná korektná e-mailová adresa(napr. janko@hrasko.sk)')				 ->setRequired('E-mailová adresa musí byť zadaná!');    if ($id_reg > 2) { $form->addSelect('id_registracia', 'Úroveň registrácie člena:', $urovneReg); }    if ($user_view_fields["rok"]) {      $form->addText('rok', 'Rok narodenia:', 4, 5)           ->addRule(Form::RANGE, 'Rok narodenia musí byť v rozsahu od %d do %d', [1900, StrFTime("%Y", Time())]);    }    if ($user_view_fields["telefon"]) {      $form->addText('telefon', 'Telefón:', 20, 20);    }    if ($user_view_fields["poznamka"]) {      $form->addText('poznamka', 'Poznámka:', 50, 250);    }    if ($user_view_fields["pohl"]) {      $form->addSelect('pohl', 'Pohlavie:', ['M'=>'Muž','Z'=>'Žena']);    }    $form->onValidate[] = [$this, 'validateEditUserForm'];    $form->addSubmit('uloz', 'Ulož')         ->setAttribute('class', 'btn btn-success');    $form->addSubmit('cancel', 'Cancel')->setAttribute('class', 'btn btn-default')         ->setValidationScope(FALSE);		return $form;	}    /** Vlastná validácia   * @param Nette\Application\UI\Form $button   */  public function validateEditUserForm($button) {    $values = $button->getForm()->getValues();    if ($button->isSubmitted()->name == 'uloz') {      $user = $this->users->find($values->id_users);      // Over, ci dane username uz existuje.      $uu = $this->users->findOneBy(['username'=>$values->username]);      if ($uu && $user->id <> $uu->id) {        $button->addError(sprintf('Zadané užívateľské meno %s už existuje! Zvolte prosím iné!', $values->username));      }      // Over, ci dany email uz existuje.      $ue = $this->users->findOneBy(['email'=>$values->email]);      if ($ue && $user->id <> $ue->id) {        $button->addError(sprintf('Zadaný e-mail %s už existuje! Zvolte prosím iný!', $values->email));      }    }  }}